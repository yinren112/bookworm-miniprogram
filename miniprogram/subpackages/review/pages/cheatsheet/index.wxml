<!-- subpackages/review/pages/cheatsheet/index.wxml -->
<!-- 急救包页面 -->
<view class="container" bindtouchstart="onUserInteraction" bindtouchmove="onUserInteraction">
  <view class="page-header" wx:if="{{!loading && !error}}">
    <text class="page-title">急救包</text>
    <text class="page-subtitle">快速回顾核心知识点</text>
  </view>

  <loading-state wx:if="{{loading}}" variant="page" text="正在加载急救包..." />
  <error-state wx:elif="{{error}}" title="加载失败" desc="{{errorMsg || '请重试'}}" bind:retry="loadCheatSheets" />
  <empty-state
    title="暂无内容"
    desc="急救包正在准备中"
    actionText="返回课程"
    actionType="secondary"
    showAction
    bind:action="goBack"
    wx:elif="{{!loading && !error && cheatSheets.length === 0}}"
  />

  <view class="cheatsheet-list" wx:if="{{!loading && !error && cheatSheets.length > 0}}">
    <card-flat wx:for="{{cheatSheets}}" wx:key="id" clickable custom-class="cheatsheet-item" bind:tap="previewCheatSheet" data-index="{{index}}">
      <view class="item-row">
        <view class="item-icon item-icon--{{item.assetTypeNormalized}}">
          <text>{{assetTypeIcons[item.assetTypeNormalized]}}</text>
        </view>
        <view class="item-content">
          <text class="item-title">{{item.title}}</text>
          <view class="item-meta">
            <pill-tag variant="neutral" size="sm">{{item.assetTypeLabel}}</pill-tag>
            <pill-tag variant="neutral" size="sm" wx:if="{{item.version}}">v{{item.version}}</pill-tag>
          </view>
        </view>
        <view class="item-actions" wx:if="{{item.assetTypeNormalized === 'image'}}">
          <juicy-button type="secondary" size="sm" hapticEnabled="{{false}}" data-index="{{index}}" catch:tap="saveCheatSheet">保存</juicy-button>
        </view>
      </view>
    </card-flat>
  </view>

  <view class="footer-tip" wx:if="{{!loading && !error && cheatSheets.length > 0}}">
    <text>长按图片可保存</text>
  </view>
</view>
