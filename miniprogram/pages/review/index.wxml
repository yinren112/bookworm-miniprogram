<!-- pages/review/index.wxml -->
<!-- å¤ä¹ é¦–é¡µ -->
<view class="container">
  <!-- å¤´éƒ¨é—®å€™ -->
  <view class="header-section">
    <text class="greeting-text">ä½ å¥½ï¼ŒåŒå­¦ ğŸ‘‹</text>
    <text class="greeting-sub">ä»Šå¤©ä¹Ÿè¦åšæŒå­¦ä¹ å“¦</text>
  </view>
  <!-- ä»Šæ—¥ä»»åŠ¡ Hero Card -->
  <view class="hero-card clay-card">
    <view class="hero-header">
      <view class="date-badge">
        <text class="date-text">{{todayDate}}</text>
      </view>
    </view>
    <view class="hero-content" wx:if="{{!loading && todaySummary}}">
      <view class="progress-ring-container">
        <!-- ç®€å•çš„åœ†å½¢è¿›åº¦å¯è§†åŒ–ï¼Œè¿™é‡Œç”¨CSSå®ç° -->
        <view class="progress-circle">
          <text class="progress-number">{{todaySummary.dueCards || 0}}</text>
          <text class="progress-label">å¾…å¤ä¹ </text>
          <view class="estimate-badge" wx:if="{{todaySummary.dueCards > 0 && todaySummary.estimatedMinutes}}">
            <text>çº¦ {{todaySummary.estimatedMinutes}} åˆ†é’Ÿ</text>
          </view>
        </view>
      </view>
      <view class="hero-stats">
        <view class="hero-stat-item">
          <text class="h-stat-num">{{todaySummary.newCards || 0}}</text>
          <text class="h-stat-label">æ–°å¡ç‰‡</text>
        </view>
        <view class="h-divider"></view>
        <view class="hero-stat-item">
          <text class="h-stat-num">{{todaySummary.reviewedToday || 0}}</text>
          <text class="h-stat-label">å·²å®Œæˆ</text>
        </view>
      </view>
    </view>
    <view class="hero-actions" wx:if="{{!loading && currentCourse}}">
      <button class="hero-btn primary" bindtap="startReview">
        <text>å¼€å§‹èƒŒå¡</text>
        <text class="icon">ğŸ“š</text>
      </button>
      <button class="hero-btn secondary" bindtap="startQuiz">
        <text>åˆ·é¢˜é—¯å…³</text>
        <text class="icon">ğŸ“</text>
      </button>
    </view>
    <view class="loading-state" wx:if="{{loading}}">
      <text class="loading-text">åŠ è½½æ•°æ®ä¸­...</text>
    </view>
  </view>
  <!-- è¿ç»­å­¦ä¹  -->
  <!-- Streak Heatmap Section -->
  <view class="streak-section clay-card-sm" wx:if="{{!loading}}" bindtap="navigateToLeaderboard">
    <view class="streak-header">
      <view class="streak-title-group">
        <text class="streak-days">{{streakInfo.currentStreak || 0}}</text>
        <text class="streak-label">å¤©è¿ç»­å­¦ä¹ </text>
      </view>
      <text class="streak-sub">ä¿æŒçƒ­åº¦ï¼Œä»æœªæ­¢æ­¥</text>
    </view>
    <view class="heatmap-grid" wx:if="{{heatmapData.length > 0}}">
      <block wx:for="{{heatmapData}}" wx:key="index">
        <view class="heatmap-cell level-{{item.level}}"></view>
      </block>
    </view>
  </view>
  <!-- è¯¾ç¨‹åˆ—è¡¨ -->
  <view class="courses-section">
    <text class="section-heading">æˆ‘çš„è¯¾ç¨‹</text>
    <block wx:if="{{!loading && courses.length > 0}}">
      <view class="course-list">
        <view class="course-card clay-card-sm" wx:for="{{courses}}" wx:key="id" bindtap="navigateToCourse" data-course-key="{{item.courseKey}}">
          <view class="course-icon-placeholder">{{item.title[0]}}</view>
          <view class="course-details">
            <text class="course-name">{{item.title}}</text>
            <view class="course-tags">
              <text class="mini-tag">{{item.totalCards || 0}} å¡ç‰‡</text>
            </view>
          </view>
          <view class="course-enter-btn">
            <text>è¿›å…¥</text>
          </view>
        </view>
      </view>
    </block>
    <!-- Empty State -->
    <block wx:if="{{!loading && courses.length === 0}}">
      <view class="empty-state">
        <text class="empty-text">è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•è¯¾ç¨‹</text>
        <block wx:if="{{recommendedCourses.length > 0}}">
          <view class="recommend-divider">
            <text>ä¸ºæ‚¨æ¨è</text>
          </view>
          <view class="course-list">
            <block wx:for="{{recommendedCourses}}" wx:key="id">
              <view class="course-card clay-card-sm" bindtap="navigateToCourse" data-course-key="{{item.courseKey}}">
                <view class="course-icon-placeholder">{{item.title[0]}}</view>
                <view class="course-details">
                  <text class="course-name">{{item.title}}</text>
                  <text class="mini-tag">çƒ­é—¨æ¨è</text>
                </view>
                <view class="course-enter-btn">æŸ¥çœ‹</view>
              </view>
            </block>
          </view>
        </block>
      </view>
    </block>
  </view>
</view>