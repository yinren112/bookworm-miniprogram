<!--pages/order-confirm/index.wxml-->
<wxs module="filters" src="../../utils/filters.wxs"></wxs>

<view class="container page-container">
  <!-- Decorative Blobs -->
  <view class="bg-blob bg-blob-1"></view>
  <view class="bg-blob bg-blob-2"></view>

  <view wx:if="{{book}}" class="anim-fade-in-up">
    
    <!-- Product Card (Ticket Style) -->
    <view class="ticket-card">
      <view class="ticket-main">
        <image class="book-cover" src="{{book.bookSku.cover_image_url || '/images/placeholder-cover.svg'}}" mode="aspectFill" />
        <view class="book-info">
          <text class="book-title">{{book.bookSku.bookMaster.title}}</text>
          <text class="book-author">{{book.bookSku.bookMaster.author || 'ä½œè€…æœªçŸ¥'}}</text>
          <view class="condition-tag">{{book.condition}}</view>
        </view>
      </view>
      
      <!-- Dotted Line -->
      <view class="ticket-divider">
        <view class="half-circle left"></view>
        <view class="line"></view>
        <view class="half-circle right"></view>
      </view>
      
      <view class="ticket-stub">
        <view class="price-row">
          <text class="label">å•†å“é‡‘é¢</text>
          <text class="value clay-num">{{filters.formatCurrency(book.selling_price)}}</text>
        </view>
        <view class="price-row">
          <text class="label">è¿è´¹</text>
          <text class="value clay-num">Â¥0.00</text>
        </view>
      </view>
    </view>

    <!-- Tips Card -->
    <view class="tips-card">
      <view class="tips-title">ğŸ’¡ æ¸©é¦¨æç¤º</view>
      <view class="tips-content">
        è¯·åœ¨ä¸‹å•å <text class="highlight">48å°æ—¶å†…</text> å‰å¾€æŒ‡å®šåœ°ç‚¹å–è´§ï¼Œè¶…æ—¶è®¢å•å°†è‡ªåŠ¨å–æ¶ˆã€‚
      </view>
    </view>

  </view>
  
  <!-- Error State -->
  <view wx:else class="error-message anim-fade-in-up">
    å•†å“ä¿¡æ¯åŠ è½½å¤±è´¥
  </view>

  <!-- Glass Footer -->
  <view class="glass-footer anim-fade-in-up" wx:if="{{book}}">
    <view class="total-section">
      <text class="total-label">å®ä»˜æ¬¾</text>
      <view class="total-price-box">
        <text class="currency">Â¥</text>
        <text class="amount clay-num">{{filters.formatCurrencyFromCents(book.selling_price).substring(1)}}</text>
      </view>
    </view>
    <button class="pay-btn" bindtap="handlePayment" disabled="{{isSubmitting}}">
      {{isSubmitting ? 'æ”¯ä»˜ä¸­...' : 'ç«‹å³æ”¯ä»˜'}}
    </button>
  </view>

</view>
