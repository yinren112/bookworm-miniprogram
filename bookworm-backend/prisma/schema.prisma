generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Order {
  id               Int                    @id @default(autoincrement())
  user_id          Int
  web_staff_id     Int?                   // Web员工 (Staff表，仅SELL订单使用)
  status           OrderStatus            @default(PENDING_PAYMENT)
  total_amount     Int                    @db.Integer
  pickup_code      String                 @unique @db.VarChar(16)
  createdAt        DateTime               @default(now()) @db.Timestamptz(6)
  paymentExpiresAt DateTime               @db.Timestamptz(6)
  pickupExpiresAt  DateTime?              @db.Timestamptz(6)
  paid_at          DateTime?              @db.Timestamptz(6)
  completed_at     DateTime?              @db.Timestamptz(6)
  cancelled_at     DateTime?              @db.Timestamptz(6)
  type             OrderType              @default(PURCHASE)
  totalWeightKg    Float?                 @map("total_weight_kg")
  unitPrice        Int?                   @map("unit_price")
  settlementType   SettlementType?        @map("settlement_type")
  voucherFaceValue Int?                   @map("voucher_face_value")
  notes            String?
  User             User                   @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user")
  WebStaff         Staff?                 @relation("WebStaffSellOrders", fields: [web_staff_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  orderItem        OrderItem[]
  PaymentRecord    PaymentRecord[]
  reservations     InventoryReservation[]
  pendingGuard     PendingPaymentOrder?
  sourcedInventory InventoryItem[]        @relation("SourceOrder")
  sellDetails      OrderSellDetails?

  @@index([user_id, status], map: "idx_order_user_id_status")
  @@index([createdAt], map: "idx_order_created_at")
  @@index([user_id, createdAt, id], map: "idx_order_user_created_at_id")
  @@index([web_staff_id], map: "idx_order_web_staff_id")
}

model PendingPaymentOrder {
  order_id   Int      @id
  user_id    Int
  created_at DateTime @default(now()) @db.Timestamptz(6)

  Order Order @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_pending_order")
  User  User  @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_pending_user")

  @@unique([user_id], map: "uniq_order_pending_per_user")
  @@map("pending_payment_order")
}

model OrderSellDetails {
  order_id          Int             @id
  total_weight_kg   Float
  unit_price        Int
  settlement_type   SettlementType
  voucher_face_value Int?
  created_at        DateTime        @default(now()) @db.Timestamptz(6)

  Order Order @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: Cascade, map: "fk_order_sell_details_order")

  @@index([order_id], map: "order_sell_details_order_id_idx")
  @@map("order_sell_details")
}

model User {
  id                   Int                   @id @default(autoincrement())
  openid               String                @unique @db.VarChar(255)
  unionid              String?               @unique @db.VarChar(255)
  nickname             String?               @db.VarChar(255)
  avatar_url           String?               @db.VarChar(255)
  role                 Role                  @default(USER)
  phone_number         String?               @unique @db.VarChar(20)
  status               UserStatus            @default(REGISTERED)
  created_at           DateTime              @default(now()) @db.Timestamptz(6)
  Order                Order[]
  pendingOrders        PendingPaymentOrder[]
  StaffAcquisitions    Acquisition[]         @relation("StaffAcquisitions")
  CustomerAcquisitions Acquisition[]         @relation("CustomerAcquisitions")
  profile              UserProfile?

  // 复习系统关联
  courseEnrollments UserCourseEnrollment[]
  cardStates        UserCardState[]
  questionAttempts  UserQuestionAttempt[]
  wrongItems        UserWrongItem[]
  studyStreak       UserStudyStreak?
  studyFeedbacks    StudyFeedback[]

  @@index([phone_number])
}

model BookMaster {
  id             Int       @id @default(autoincrement())
  isbn13         String    @unique @db.VarChar(13)
  title          String    @db.VarChar(255)
  author         String?   @db.VarChar(255)
  publisher      String?   @db.VarChar(255)
  original_price Int?
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime  @updatedAt @db.Timestamptz(6)
  bookSku        BookSku[]

  @@index([isbn13], map: "idx_book_master_isbn13")
  @@index([author(ops: raw("gin_trgm_ops"))], map: "idx_bookmaster_author_gin_trgm", type: Gin)
  @@index([title(ops: raw("gin_trgm_ops"))], map: "idx_bookmaster_title_gin_trgm", type: Gin)
  @@map("bookmaster")
}

model BookSku {
  id                   Int                   @id @default(autoincrement())
  master_id            Int
  edition              String?               @db.VarChar(50)
  description          String?
  cover_image_url      String?               @db.VarChar(255)
  created_at           DateTime              @default(now()) @db.Timestamptz(6)
  updated_at           DateTime              @updatedAt @db.Timestamptz(6)
  is_acquirable        Boolean               @default(false)
  bookMaster           BookMaster            @relation(fields: [master_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_master")
  inventoryItems       InventoryItem[]
  recommendedBookItems RecommendedBookItem[]

  @@unique([master_id, edition])
  @@index([is_acquirable], map: "booksku_is_acquirable_idx")
  @@map("booksku")
}

model InventoryItem {
  id            Int                   @id @default(autoincrement())
  sku_id        Int
  condition     book_condition
  cost          Int
  selling_price Int
  status        inventory_status      @default(in_stock)
  created_at    DateTime              @default(now()) @db.Timestamptz(6)
  updated_at    DateTime              @updatedAt @db.Timestamptz(6)
  sourceOrderId Int?                  @map("source_order_id")
  acquisitionId Int?                  @map("acquisition_id")
  bookSku       BookSku               @relation(fields: [sku_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_sku")
  orderItem     OrderItem[]
  reservation   InventoryReservation?
  SourceOrder   Order?                @relation("SourceOrder", fields: [sourceOrderId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  Acquisition   Acquisition?          @relation(fields: [acquisitionId], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@index([sku_id, status], map: "idx_inventory_item_sku_id_status")
  @@index([sourceOrderId])
  @@index([acquisitionId], map: "inventoryitem_acquisition_id_idx")
  @@map("inventoryitem")
}

model InventoryReservation {
  inventory_item_id Int      @id
  order_id          Int
  created_at        DateTime @default(now()) @db.Timestamptz(6)

  inventoryItem InventoryItem @relation(fields: [inventory_item_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_reservation_item")
  order         Order         @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_reservation_order")

  @@index([order_id], map: "idx_inventory_reservation_order_id")
  @@map("inventory_reservation")
}

model OrderItem {
  id                Int           @id @default(autoincrement())
  order_id          Int
  inventory_item_id Int
  price             Int
  inventoryItem     InventoryItem @relation(fields: [inventory_item_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_inventory_item")
  Order             Order         @relation(fields: [order_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_order")

  @@unique([order_id, inventory_item_id], map: "uniq_orderitem_order_inventory")
  @@index([inventory_item_id], map: "idx_orderitem_inventory_item_id")
  @@map("orderitem")
}

model Content {
  id        Int      @id @default(autoincrement())
  slug      String   @unique @db.VarChar(255)
  title     String   @db.VarChar(255)
  body      String
  createdAt DateTime @default(now()) @db.Timestamptz(6)
  updatedAt DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  @@index([slug], map: "idx_content_slug")
}

model PaymentRecord {
  id              Int           @id @default(autoincrement())
  order_id        Int
  out_trade_no    String        @unique @db.VarChar(100)
  transaction_id  String?       @unique @db.VarChar(100)
  status          PaymentStatus @default(PENDING)
  amount_total    Int
  payer_openid    String?       @db.VarChar(255)
  appid           String?       @db.VarChar(100)
  mchid           String?       @db.VarChar(100)
  createdAt       DateTime      @default(now()) @db.Timestamptz(6)
  updatedAt       DateTime      @updatedAt @db.Timestamptz(6)
  notified_at     DateTime?     @db.Timestamptz(6)
  refunded_at     DateTime?     @db.Timestamptz(6)
  refund_id       String?       @unique @db.VarChar(100)
  refund_attempts Int           @default(0)
  Order           Order         @relation(fields: [order_id], references: [id])

  @@index([order_id])
  @@index([status, createdAt])
}

model Acquisition {
  id               Int             @id @default(autoincrement())
  staff_user_id    Int?            // 小程序员工 (User表)
  customer_user_id Int?
  web_staff_id     Int?            // Web员工 (Staff表)
  total_value      Int
  item_count       Int
  settlement_type  SettlementType
  voucher_code     String?         @db.VarChar(255)
  notes            String?
  created_at       DateTime        @default(now()) @db.Timestamptz(6)
  StaffUser        User?           @relation("StaffAcquisitions", fields: [staff_user_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  CustomerUser     User?           @relation("CustomerAcquisitions", fields: [customer_user_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  WebStaff         Staff?          @relation("WebStaffAcquisitions", fields: [web_staff_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  items            InventoryItem[]

  @@index([staff_user_id], map: "Acquisition_staff_user_id_idx")
  @@index([web_staff_id], map: "Acquisition_web_staff_id_idx")
  @@index([created_at], map: "Acquisition_created_at_idx")
}

enum book_condition {
  NEW
  GOOD
  ACCEPTABLE
}

enum inventory_status {
  in_stock
  reserved
  sold
  returned
  damaged
  BULK_ACQUISITION
}

enum OrderType {
  PURCHASE
  SELL
}

enum SettlementType {
  CASH
  VOUCHER
}

enum Role {
  USER
  STAFF
}

enum UserStatus {
  REGISTERED
  PRE_REGISTERED
}

enum OrderStatus {
  PENDING_PAYMENT
  PENDING_PICKUP
  COMPLETED
  CANCELLED
  RETURNED
}

enum PaymentStatus {
  PENDING
  SUCCESS
  REFUND_REQUIRED
  REFUNDED
  FAILED
  REFUND_PROCESSING
}

model UserProfile {
  user_id         Int      @id
  enrollment_year Int?
  major           String?  @db.VarChar(100)
  class_name      String?  @db.VarChar(50)
  updated_at      DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  user User @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  // Performance: Index for recommendation lookups and future analytics queries
  // Composite index covers: (enrollment_year, major) and (enrollment_year) queries
  @@index([enrollment_year, major])
}

model RecommendedBookList {
  id              Int                   @id @default(autoincrement())
  enrollment_year Int
  major           String                @db.VarChar(100)
  items           RecommendedBookItem[]

  @@unique([enrollment_year, major])
  @@index([enrollment_year])
}

model RecommendedBookItem {
  list_id Int
  sku_id  Int

  list    RecommendedBookList @relation(fields: [list_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  bookSku BookSku             @relation(fields: [sku_id], references: [id], onDelete: Restrict, onUpdate: Cascade)

  @@id([list_id, sku_id])
  @@index([sku_id])
}

model WebhookEvent {
  id          String   @id @db.VarChar(64)
  event_type  String   @db.VarChar(50)
  received_at DateTime @default(now()) @db.Timestamptz(6)
  processed   Boolean  @default(false)

  @@index([received_at])
  @@map("webhook_events")
}

// ============================================
// Web员工系统 (临时过渡方案，小程序上架后废弃)
// ============================================

enum StaffRole {
  STAFF // 普通员工：只能收书
  ADMIN // 管理员：收书 + 管理员工 + 查看所有人统计
}

enum StaffStatus {
  ACTIVE
  DISABLED
}

model Staff {
  id            Int         @id @default(autoincrement())
  username      String      @unique @db.VarChar(50)
  password_hash String      @db.VarChar(255)
  display_name  String      @db.VarChar(100)
  role          StaffRole   @default(STAFF)
  status        StaffStatus @default(ACTIVE)
  created_at    DateTime    @default(now()) @db.Timestamptz(6)
  updated_at    DateTime    @updatedAt @db.Timestamptz(6)
  last_login_at DateTime?   @db.Timestamptz(6)

  acquisitions Acquisition[] @relation("WebStaffAcquisitions")
  sellOrders   Order[]       @relation("WebStaffSellOrders")

  @@index([username])
  @@index([status])
  @@map("staff")
}

// ============================================
// 复习系统 (Study Domain) - 与库存/订单域完全隔离
// ============================================

// 复习系统枚举
enum QuestionType {
  SINGLE_CHOICE
  MULTI_CHOICE
  TRUE_FALSE
  FILL_BLANK
}

enum FeedbackRating {
  FORGOT  // 不会 -> boxLevel = 1
  FUZZY   // 模糊 -> boxLevel = max(1, current - 1)
  KNEW    // 会   -> boxLevel = min(5, current + 1)
  PERFECT // 很熟 -> boxLevel = min(5, current + 2)
}

enum FeedbackReasonType {
  ANSWER_ERROR
  STEM_AMBIGUOUS
  EXPLANATION_UNCLEAR
  FORMAT_ERROR
  OTHER
}

enum StudyFeedbackStatus {
  PENDING
  REVIEWED
  RESOLVED
  REJECTED
}

enum CourseStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

// ============================================
// 复习系统 - 内容侧模型 (Content Models)
// ============================================

model StudyCourse {
  id             Int          @id @default(autoincrement())
  courseKey      String       @db.VarChar(100) // e.g., "MA101"
  title          String       @db.VarChar(255)
  description    String?
  contentVersion Int          @default(1) @map("content_version")
  locale         String       @default("zh-CN") @db.VarChar(10)
  status         CourseStatus @default(DRAFT)
  totalCards     Int          @default(0) @map("total_cards")
  totalQuestions Int          @default(0) @map("total_questions")
  createdAt      DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime     @updatedAt @map("updated_at") @db.Timestamptz(6)

  units       StudyUnit[]
  cheatSheets StudyCheatSheet[]
  enrollments UserCourseEnrollment[]
  campaignMaps StudyCampaignMap[]
  feedbacks   StudyFeedback[]

  @@unique([courseKey, contentVersion])
  @@index([status, courseKey])
  @@map("study_course")
}

model StudyUnit {
  id         Int      @id @default(autoincrement())
  courseId   Int      @map("course_id")
  unitKey    String   @db.VarChar(100) // e.g., "limit", "derivative"
  title      String   @db.VarChar(255)
  orderIndex Int      @default(0) @map("order_index")
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  course      StudyCourse      @relation(fields: [courseId], references: [id], onDelete: Cascade)
  cards       StudyCard[]
  questions   StudyQuestion[]
  cheatSheets StudyCheatSheet[]

  @@unique([courseId, unitKey])
  @@index([courseId, orderIndex])
  @@map("study_unit")
}

model StudyCard {
  id         Int      @id @default(autoincrement())
  courseId   Int      @map("course_id")
  unitId     Int      @map("unit_id")
  contentId  String   @db.VarChar(100) // 课程包内唯一ID，用于进度继承
  front      String   @db.Text // 正面（问题/提示）
  back       String   @db.Text // 背面（答案/解释）
  tags       String?  @db.VarChar(255) // 逗号分隔的标签
  difficulty Int      @default(1) // 1-5 难度等级
  sortOrder  Int      @default(0) @map("sort_order")
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  unit       StudyUnit       @relation(fields: [unitId], references: [id], onDelete: Cascade)
  userStates UserCardState[]
  feedbacks  StudyFeedback[] @relation("CardFeedbacks")

  @@unique([unitId, contentId])
  @@index([unitId, sortOrder])
  @@index([courseId])
  @@map("study_card")
}

model StudyQuestion {
  id               Int          @id @default(autoincrement())
  courseId         Int          @map("course_id")
  unitId           Int          @map("unit_id")
  contentId        String       @db.VarChar(100)
  questionType     QuestionType @map("question_type")
  stem             String       @db.Text // 题干
  optionsJson      Json?        @map("options_json") // 选项 JSON: ["A. xxx", "B. xxx", ...]
  answerJson       String       @db.VarChar(500) @map("answer_json") // 正确答案
  explanationShort String?      @map("explanation_short") @db.Text // 一句话解析
  difficulty       Int          @default(1)
  sortOrder        Int          @default(0) @map("sort_order")
  createdAt        DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)

  unit       StudyUnit             @relation(fields: [unitId], references: [id], onDelete: Cascade)
  attempts   UserQuestionAttempt[]
  wrongItems UserWrongItem[]
  feedbacks  StudyFeedback[]       @relation("QuestionFeedbacks")

  @@unique([unitId, contentId])
  @@index([unitId, sortOrder])
  @@index([courseId])
  @@map("study_question")
}

model StudyCheatSheet {
  id        Int      @id @default(autoincrement())
  courseId  Int      @map("course_id")
  unitId    Int?     @map("unit_id") // 可选：关联到特定章节
  title     String   @db.VarChar(255)
  assetType String   @db.VarChar(20) // "pdf" | "image"
  url       String   @db.VarChar(500)
  version   Int      @default(1)
  sortOrder Int      @default(0) @map("sort_order")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  course StudyCourse @relation(fields: [courseId], references: [id], onDelete: Cascade)
  unit   StudyUnit?  @relation(fields: [unitId], references: [id], onDelete: SetNull)

  @@index([courseId, sortOrder])
  @@map("study_cheat_sheet")
}

model StudyCampaignMap {
  id        Int      @id @default(autoincrement())
  sceneCode String   @unique @db.VarChar(32) // 小程序码 scene 参数，e.g., "R9xK2pQ"
  courseId  Int      @map("course_id")
  unitKey   String?  @db.VarChar(100) // 可选：直接跳转到特定章节
  note      String?  @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  course StudyCourse @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([sceneCode])
  @@map("study_campaign_map")
}

// ============================================
// 复习系统 - 进度侧模型 (Progress Models)
// ============================================

model UserCourseEnrollment {
  id             Int       @id @default(autoincrement())
  userId         Int       @map("user_id")
  courseId       Int       @map("course_id")
  enrolledAt     DateTime  @default(now()) @map("enrolled_at") @db.Timestamptz(6)
  sourceScene    String?   @map("source_scene") @db.VarChar(32) // 来源扫码场景
  lastStudiedAt  DateTime? @map("last_studied_at") @db.Timestamptz(6)
  completedCards Int       @default(0) @map("completed_cards")

  user   User        @relation(fields: [userId], references: [id], onDelete: Cascade)
  course StudyCourse @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@index([userId, lastStudiedAt])
  @@map("user_course_enrollment")
}

model UserCardState {
  id              Int       @id @default(autoincrement())
  userId          Int       @map("user_id")
  cardId          Int       @map("card_id")
  boxLevel        Int       @default(1) @map("box_level") // Leitner 1-5
  nextDueAt       DateTime  @map("next_due_at") @db.Timestamptz(6) // 下次复习时间
  lastAnsweredAt  DateTime? @map("last_answered_at") @db.Timestamptz(6)
  lastSessionId   String?   @map("last_session_id") @db.VarChar(36)
  todayShownCount Int       @default(0) @map("today_shown_count") // 今日已显示次数
  totalAttempts   Int       @default(0) @map("total_attempts")
  createdAt       DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)

  user User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  card StudyCard @relation(fields: [cardId], references: [id], onDelete: Cascade)

  @@unique([userId, cardId])
  @@index([userId, nextDueAt]) // 今日队列核心查询
  @@map("user_card_state")
}

model UserQuestionAttempt {
  id               Int      @id @default(autoincrement())
  userId           Int      @map("user_id")
  questionId       Int      @map("question_id")
  sessionId        String   @db.VarChar(36) @map("session_id") // Quiz session UUID
  chosenAnswerJson String   @map("chosen_answer_json") @db.VarChar(500)
  isCorrect        Boolean  @map("is_correct")
  durationMs       Int?     @map("duration_ms")
  attemptedAt      DateTime @default(now()) @map("attempted_at") @db.Timestamptz(6)

  user     User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  question StudyQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([sessionId, userId, questionId], map: "uniq_attempt_session_user_question") // Idempotency: one attempt per session+user+question
  @@index([userId, sessionId])
  @@index([questionId, isCorrect])
  @@map("user_question_attempt")
}

model UserWrongItem {
  id         Int       @id @default(autoincrement())
  userId     Int       @map("user_id")
  questionId Int       @map("question_id")
  wrongCount Int       @default(1) @map("wrong_count")
  lastWrongAt DateTime @default(now()) @map("last_wrong_at") @db.Timestamptz(6)
  clearedAt  DateTime? @map("cleared_at") @db.Timestamptz(6) // null = 仍在错题本

  user     User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  question StudyQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([userId, questionId])
  @@index([userId, clearedAt]) // 查询未解决的错题
  @@map("user_wrong_item")
}

model UserStudyStreak {
  id            Int       @id @default(autoincrement())
  userId        Int       @unique @map("user_id")
  currentStreak Int       @default(0) @map("current_streak") // 当前连续天数
  bestStreak    Int       @default(0) @map("best_streak") // 历史最长
  lastStudyDate DateTime? @map("last_study_date") @db.Date
  weeklyPoints  Int       @default(0) @map("weekly_points") // 本周积分
  weekStartDate DateTime? @map("week_start_date") @db.Date
  updatedAt     DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([weeklyPoints]) // 周榜排序
  @@map("user_study_streak")
}

model StudyFeedback {
  id         Int                 @id @default(autoincrement())
  userId     Int                 @map("user_id")
  courseId   Int                 @map("course_id")
  cardId     Int?                @map("card_id")
  questionId Int?                @map("question_id")
  reason     FeedbackReasonType
  message    String              @db.Text
  status     StudyFeedbackStatus @default(PENDING)
  createdAt  DateTime            @default(now()) @map("created_at") @db.Timestamptz(6)
  resolvedAt DateTime?           @map("resolved_at") @db.Timestamptz(6)

  user     User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  course   StudyCourse    @relation(fields: [courseId], references: [id], onDelete: Cascade)
  card     StudyCard?     @relation("CardFeedbacks", fields: [cardId], references: [id], onDelete: SetNull)
  question StudyQuestion? @relation("QuestionFeedbacks", fields: [questionId], references: [id], onDelete: SetNull)

  @@index([status, createdAt])
  @@index([courseId])
  @@map("study_feedback")
}
