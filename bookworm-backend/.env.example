# Environment Configuration
NODE_ENV=development
LOG_LEVEL=info

# Server Configuration
PORT=8080
HOST=0.0.0.0

# Database Configuration
# Development database (use with docker-compose)
DATABASE_URL="postgresql://postgres:password@localhost:5432/bookworm?schema=public&connection_limit=50&pool_timeout=10"
# Test database (use with docker-compose --profile test)
TEST_DATABASE_URL="postgresql://postgres:password@localhost:5433/bookworm_test?schema=public&connection_limit=5&pool_timeout=15"

# JWT Configuration
JWT_SECRET="your-secret-key-here"
JWT_EXPIRES_IN=7d

# WeChat Mini Program Configuration
WX_APP_ID="YOUR_APP_ID"
WX_APP_SECRET="YOUR_APP_SECRET"

# WeChat Pay Configuration (optional for development)
WXPAY_MCHID=""
WXPAY_PRIVATE_KEY_PATH="/secrets/wechatpay/apiclient_key.pem"
WXPAY_CERT_SERIAL_NO=""
WXPAY_API_V3_KEY=""
WXPAY_NOTIFY_URL=""
WXPAY_ACK_STRICT=false

# External API Configuration
TANSHU_API_KEY=""

# Business Logic Configuration (Magic Numbers - defaults in config.ts)
ORDER_PAYMENT_TTL_MINUTES=15
ORDER_PICKUP_CODE_LENGTH=8
ORDER_PICKUP_CODE_BYTES=5
MAX_ITEMS_PER_ORDER=10
# MAX_RESERVED_ITEMS_PER_USER is mirrored into the Postgres runtime for trigger enforcement
MAX_RESERVED_ITEMS_PER_USER=20
API_RATE_LIMIT_MAX=5
API_RATE_LIMIT_WINDOW_MINUTES=1

# Business Logic Constants

# Database Transaction Retry Configuration
DB_TRANSACTION_RETRY_COUNT=3
DB_TRANSACTION_RETRY_BASE_DELAY_MS=20
DB_TRANSACTION_RETRY_JITTER_MS=40
PICKUP_CODE_RETRY_COUNT=5

# Payment Security
PAYMENT_TIMESTAMP_TOLERANCE_SECONDS=300

# Scheduled Job Configuration
CRON_ORDER_CLEANUP="*/1 * * * *"
CRON_INVENTORY_METRICS="*/5 * * * *"
CRON_WECHAT_CERT_REFRESH="0 */10 * * *"
CRON_REFUND_PROCESSOR="*/10 * * * *"
CRON_STUDY_REMINDER="0 9 * * *"
STUDY_REMINDER_TEMPLATE_ID=""

# API Rate Limiting
API_LOGIN_RATE_LIMIT_MAX=10
API_FULFILL_RATE_LIMIT_MAX=30

# Metrics
METRICS_AUTH_TOKEN=""
METRICS_ALLOW_ANONYMOUS=false
